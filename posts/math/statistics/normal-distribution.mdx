---
title: "正規分布を理解する"
date: "2024-03-20"
description: "正規分布、その特性、および統計学とデータサイエンスにおける応用についての包括的なガイド。"
tags: ["統計", "数学", "確率"]
author: "Your Name"
readTime: "10 分"
featured: false
---

# 正規分布を理解する

正規分布は、ガウス分布としても知られ、統計学において最も重要な確率分布の一つです。多くの実世界の現象に自然に現れ、多くの統計手法の基礎を形成しています。

## 正規分布の式

正規分布の確率密度関数（PDF）は次のように与えられます：

$$
f(x) = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}
$$

ここで：
- $\mu$ は平均（分布の中心）
- $\sigma$ は標準偏差（分布の広がり）
- $\sigma^2$ は分散

## 主要な特性

### 1. 対称性

正規分布は平均 $\mu$ を中心に完全に対称です。これは次を意味します：

$$
P(X < \mu - a) = P(X > \mu + a)
$$

任意の値 $a > 0$ に対して。

### 2. 68-95-99.7 ルール

この経験則は次のことを述べています：
- 約**68%**の値が $\mu \pm \sigma$ 内に収まる
- 約**95%**の値が $\mu \pm 2\sigma$ 内に収まる
- 約**99.7%**の値が $\mu \pm 3\sigma$ 内に収まる

### 3. 標準正規分布

$\mu = 0$ かつ $\sigma = 1$ のとき、次のPDFを持つ**標準正規分布**になります：

$$
\phi(z) = \frac{1}{\sqrt{2\pi}} e^{-\frac{z^2}{2}}
$$

## Z スコア変換

任意の正規分布は、zスコア変換を使用して標準化できます：

$$
Z = \frac{X - \mu}{\sigma}
$$

これにより、任意の正規確率変数を標準正規確率変数に変換します。

## 中心極限定理

正規分布の重要性は**中心極限定理**から来ています。これは次のことを述べています：

> 多数の独立確率変数の和（または平均）は、元の分布に関係なく、正規分布に近づく傾向がある。

数学的には、$X_1, X_2, ..., X_n$ が平均 $\mu$ と分散 $\sigma^2$ を持つ独立確率変数である場合：

$$
\bar{X} = \frac{1}{n}\sum_{i=1}^{n} X_i
$$

$n \to \infty$ のとき、正規分布に近づきます：

$$
\bar{X} \sim N\left(\mu, \frac{\sigma^2}{n}\right)
$$

## 統計学における応用

### 仮説検定

多くの統計検定は正規分布を仮定します：

```python
from scipy import stats
import numpy as np

# サンプルデータを生成
data = np.random.normal(loc=100, scale=15, size=1000)

# 一標本t検定を実行
t_statistic, p_value = stats.ttest_1samp(data, 100)

print(f"t統計量: {t_statistic:.4f}")
print(f"p値: {p_value:.4f}")
```

### 信頼区間

標本平均の95%信頼区間は：

$$
\bar{x} \pm 1.96 \frac{\sigma}{\sqrt{n}}
$$

### 線形回帰

線形回帰では、残差が正規分布に従うと仮定します：

```python
from sklearn.linear_model import LinearRegression
import numpy as np

# データを生成
X = np.random.rand(100, 1) * 10
y = 2 * X.squeeze() + 3 + np.random.normal(0, 2, 100)

# モデルを適合
model = LinearRegression()
model.fit(X, y)

print(f"係数: {model.coef_[0]:.2f}")
print(f"切片: {model.intercept_:.2f}")
```

## 正規性の検定

### シャピロ・ウィルク検定

```python
from scipy import stats

# データが正規分布しているかテスト
statistic, p_value = stats.shapiro(data)

if p_value > 0.05:
    print("データは正規分布しているようです")
else:
    print("データは正規分布していないようです")
```

### Q-Qプロット

分位点-分位点プロットは、データの分位点と正規分布の分位点を比較します：

```python
import scipy.stats as stats
import matplotlib.pyplot as plt

# Q-Qプロットを作成
stats.probplot(data, dist="norm", plot=plt)
plt.title("Q-Qプロット")
plt.show()
```

## よくある誤解

1. **すべてのデータが正規分布ではない**: 多くの実世界の分布は歪んでいるか、裾が重い
2. **サンプルサイズが重要**: 小さなサンプルは、母集団が正規分布であっても正規に見えない場合がある
3. **外れ値が正規性に影響**: 極端な値は正規性の仮定に違反する可能性がある

## 対数正規分布

$\log(X)$ が正規分布に従うとき、$X$ は**対数正規分布**に従います：

$$
f(x) = \frac{1}{x\sigma\sqrt{2\pi}} e^{-\frac{(\ln x - \mu)^2}{2\sigma^2}}
$$

これは、株価や所得分布などの正の値を持つデータのモデリングに役立ちます。

## 最尤推定

正規分布からのサンプル $x_1, x_2, ..., x_n$ が与えられたとき、最尤推定値は：

$$
\hat{\mu} = \frac{1}{n}\sum_{i=1}^{n} x_i = \bar{x}
$$

$$
\hat{\sigma}^2 = \frac{1}{n}\sum_{i=1}^{n} (x_i - \bar{x})^2
$$

## まとめ

正規分布は統計学とデータサイエンスの基礎です。その特性、応用、および限界を理解することは、データを扱うすべての人にとって重要です。多くの統計手法は正規性を仮定していますが、次のことを覚えておくことが重要です：

- データの正規性をテストする
- 違反がいつ重要かを理解する
- 非正規データのための代替手法を知る
- 中心極限定理がしばしば助けになることを覚えておく！

## さらなる読み物

- Casella & Bergerの『統計的推測』の「正規分布」
- Freedman、Pisani、Purvesの『統計学を理解する』
- Khan Academyの正規分布コース
